{"version":3,"sources":["./src/mavo-couchdb.js"],"names":["_readOnlyError","name","Error","$","window","Bliss","Mavo","Backend","register","Class","extends","id","constructor","value","o","_this","this","statusChangesCallbacks","mavo","url","split","unauthenticatedPermissionsAttr","element","getAttribute","authenticatedPermissionsAttr","getPermissions","attr","ready","include","PouchDB","then","remoteDB","authenticatedPermissions","unauthenticatedPermissions","defaultPermissions","authenticated","unauthenticated","permissions","on","login","includes","getSession","info","onUser","userCtx","serverPushAttr","setListenForChanges","onStatusChange","callback","push","bool","_this2","syncHandler","dbName","str","i","chr","hash","length","charCodeAt","localDB","replicate","from","live","retry","data","docs","doc","compareDocRevs","_rev","rev","onNewData","err","console","error","forEach","concat","message","cancel","render","load","_this3","get","catch","status","Promise","reject","store","_this4","resolve","storeData","unsavedChanges","storing","put","_this5","_id","prop","resData","_this6","username","prompt","password","logout","_this7","off","upload","file","_this8","docId","Date","now","putAttachment","type","docA","docB","static","test","startsWith"],"mappings":"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"}