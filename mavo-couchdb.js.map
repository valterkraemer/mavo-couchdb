{"version":3,"sources":["./src/mavo-couchdb.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_readOnlyError","name","Error","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","value","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper2","Derived","result","Super","_getPrototypeOf","Reflect","construct","sham","Proxy","Date","toString","call","e","isNativeReflectConstruct","NewTarget","this","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","getPrototypeOf","_defineProperty","$","window","Bliss","Mavo","Backend","register","_Mavo$Backend","Couchdb","_super","_this","statusChangesCallbacks","id","mavo","url","split","unauthenticatedPermissionsAttr","element","getAttribute","authenticatedPermissionsAttr","getPermissions","attr","ready","include","PouchDB","then","remoteDB","authenticatedPermissions","unauthenticatedPermissions","defaultPermissions","authenticated","unauthenticated","permissions","on","login","includes","getSession","info","onUser","userCtx","serverPushAttr","setListenForChanges","callback","push","bool","_this2","syncHandler","dbName","str","chr","hash","charCodeAt","localDB","replicate","from","live","retry","data","docs","doc","compareDocRevs","_rev","rev","onNewData","err","console","error","forEach","concat","message","cancel","render","_this3","get","catch","status","Promise","reject","_this4","resolve","storeData","unsavedChanges","storing","put","_this5","_id","prop","resData","_this6","username","prompt","password","_this7","logout","off","file","_this8","docId","now","putAttachment","type","docA","docB","startsWith"],"mappings":"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"}