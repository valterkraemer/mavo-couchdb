{"version":3,"sources":["./src/mavo-couchdb.js"],"names":["_readOnlyError","name","Error","$","window","Bliss","Mavo","Backend","register","Class","extends","id","constructor","value","o","_this","this","statusChangesCallbacks","mavo","url","split","unauthenticatedPermissionsAttr","element","getAttribute","authenticatedPermissionsAttr","include","PouchDB","then","remoteDB","authenticatedPermissions","getPermissions","unauthenticatedPermissions","defaultPermissions","authenticated","unauthenticated","permissions","on","login","includes","getSession","info","onUser","userCtx","serverPushAttr","setListenForChanges","attr","onStatusChange","callback","push","bool","_this2","syncHandler","dbName","str","i","chr","hash","length","charCodeAt","localDB","replicate","from","live","retry","data","docs","doc","compareDocRevs","_rev","rev","onNewData","err","console","error","forEach","concat","message","cancel","render","load","_this3","get","catch","status","Promise","reject","store","_this4","resolve","storeData","unsavedChanges","storing","put","_this5","_id","prop","resData","_this6","username","prompt","password","logout","_this7","off","upload","file","_this8","docId","Date","now","putAttachment","type","docA","docB","static","test","startsWith"],"mappings":"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"}